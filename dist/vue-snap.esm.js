import{elementScrollByPolyfill as e}from"seamless-scroll-polyfill/dist/esm/Element.scrollBy";import t from"lodash/debounce";import{openBlock as s,createBlock as r,resolveDynamicComponent as i,withCtx as o,createCommentVNode as l,renderSlot as n,withDirectives as a,createVNode as c,vShow as d}from"vue";var h=function(e,t,s){return Math.abs(e-t)<=s},u="undefined"==typeof window,f=!u;u||"scrollBehavior"in document.documentElement.style||e();var p={props:{hideArrows:{type:Boolean,default:!1},hideArrowsOnBound:{type:Boolean,default:!1},tag:{type:String,default:"ul"},i18n:{type:Object,default:()=>({slideLeft:"Slide left",slideRight:"Slide right"}),validator:e=>["slideLeft","slideRight"].every(t=>t in e)}},data:()=>({boundLeft:!0,boundRight:!1,slidesWidth:[],wrapperScrollWidth:0,wrapperVisibleWidth:0,currentPage:0,currentPos:0,maxPages:0,step:1,observer:null,onResizeFn:null,onScrollFn:null}),watch:{currentPage(e,t){e!==t&&this.$emit("page",{current:e,previous:t})}},mounted(){this.calcOnInit(),f&&(this.onResizeFn=t(this.calcOnInit,410),this.onScrollFn=t(this.calcOnScroll,100),this.attachMutationObserver(),this.$refs.vsWrapper.addEventListener("scroll",this.onScrollFn),window.addEventListener("resize",this.onResizeFn,!1))},beforeDestroy(){f&&(this.observer.disconnect(),this.$refs.vsWrapper.removeEventListener("scroll",this.onScrollFn),window.removeEventListener("resize",this.onResizeFn,!1))},methods:{calcOnInit(){this.$refs.vsWrapper&&(this.calcWrapperWidth(),this.calcSlidesWidth(),this.calcCurrentPosition(),this.calcCurrentPage(),this.calcBounds(),this.calcMaxPages())},calcOnScroll(){this.$refs.vsWrapper&&(this.calcCurrentPosition(),this.calcCurrentPage(),this.calcBounds())},calcBounds(){const e=h(this.currentPos,0,5),t=h(this.wrapperScrollWidth-this.wrapperVisibleWidth,this.currentPos,5);e?(this.$emit("bound-left",!0),this.boundLeft=!0):this.boundLeft=!1,t?(this.$emit("bound-right",!0),this.boundRight=!0):this.boundRight=!1},calcWrapperWidth(){this.wrapperScrollWidth=this.$refs.vsWrapper.scrollWidth,this.wrapperVisibleWidth=this.$refs.vsWrapper.offsetWidth},calcSlidesWidth(){const e=[...this.$refs.vsWrapper.children];this.slidesWidth=e.map(e=>({offsetLeft:e.offsetLeft,width:e.offsetWidth}))},calcCurrentPage(){const e=this.slidesWidth.findIndex(e=>h(e.offsetLeft,this.currentPos,5));-1!==e&&-2!==e&&(this.currentPage=e||0)},calcCurrentPosition(){this.currentPos=this.$refs.vsWrapper.scrollLeft||0},calcMaxPages(){const e=this.wrapperScrollWidth-this.wrapperVisibleWidth;this.maxPages=this.slidesWidth.findIndex(({offsetLeft:t})=>t>e)-1},calcNextWidth(e){const t=e>0?this.currentPage:this.currentPage+e,s=this.slidesWidth[t].width||0;if(s)return s*e},attachMutationObserver(){this.observer=new MutationObserver(()=>{this.calcOnInit()}),this.observer.observe(this.$refs.vsWrapper,{attributes:!0,childList:!0,characterData:!0,subtree:!0})},changeSlide(e){const t=-1===e&&this.boundLeft,s=1===e&&this.boundRight;if(t||s)return;const r=this.calcNextWidth(e);r&&this.scrollTo(r)},scrollTo(e=0){this.$refs.vsWrapper.scrollBy({left:e,behavior:"smooth"})}}};const b={class:"vs-carousel"};p.render=function(e,t,h,u,f,p){return s(),r("div",b,[(s(),r(i(h.tag),{ref:"vsWrapper",class:"vs-carousel__wrapper"},{default:o(()=>[l(" @slot Slot for Slides "),n(e.$slots,"default")]),_:3},512)),l(" @slot Slot for Arrows "),h.hideArrows?l("v-if",!0):n(e.$slots,"arrows",{key:0,"change-slide":p.changeSlide,"bound-left":e.boundLeft,"bound-right":e.boundRight},()=>[a(c("button",{type:"button","aria-label":h.i18n.slideLeft,disabled:e.boundLeft,class:"\n          vs-carousel__arrows\n          vs-carousel__arrows--left\n        ",onClick:t[1]||(t[1]=e=>p.changeSlide(-1))}," ← ",8,["aria-label","disabled"]),[[d,!h.hideArrowsOnBound||!e.boundLeft]]),a(c("button",{type:"button","aria-label":h.i18n.slideRight,disabled:e.boundRight,class:"\n          vs-carousel__arrows\n          vs-carousel__arrows--right\n        ",onClick:t[2]||(t[2]=e=>p.changeSlide(1))}," → ",8,["aria-label","disabled"]),[[d,!h.hideArrowsOnBound||!e.boundRight]])])])},p.__file="src/components/Carousel/Carousel.vue";var v={props:{tag:{type:String,default:"li"}}};v.render=function(e,t,l,a,c,d){return s(),r(i(l.tag),{ref:"vsSlide",class:"vs-carousel__slide",tabindex:"0"},{default:o(()=>[n(e.$slots,"default")]),_:3},512)},v.__file="src/components/Slide/Slide.vue";var g={install:function(e){e.component("carousel",p),e.component("slide",v)}};export default g;export{p as Carousel,v as Slide};
